---
title: "R-assignment"
author: "Tianqi(Tim)"
date: "10/12/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
#part1
if (!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)

fang_et_al_genotypes <- read_tsv ("https://raw.githubusercontent.com/Kakashi-sensei/Tianqili-R-Assignment/master/fang_et_al_genotypes.txt")

snp_position <- read_tsv ("https://raw.githubusercontent.com/Kakashi-sensei/Tianqili-R-Assignment/master/snp_position.txt")

maize_fang_et_al_genotypes <- filter(fang_et_al_genotypes, Group == "ZMMLR" | Group == "ZMMIL" | Group == "ZMMMR")

teosinte_fang_et_al_genotypes <- filter(fang_et_al_genotypes, Group == "ZMPBA" | Group == "ZMPIL" | Group == "ZMPJA")

maize_fang_et_al_genotypes <- maize_fang_et_al_genotypes[,-c(1,2,3)]

maize_fang_et_al_genotypes <- t (maize_fang_et_al_genotypes)

teosinte_fang_et_al_genotypes <- teosinte_fang_et_al_genotypes[,-c(1,2,3)]

teosinte_fang_et_al_genotypes <- t (teosinte_fang_et_al_genotypes)

snp_position <- snp_position[,-c(2,5:15)]

arrange(snp_position, SNP_ID)

maize_fang_et_al_genotypes <- cbind(snp_position, maize_fang_et_al_genotypes)

teosinte_fang_et_al_genotypes <- cbind(snp_position, teosinte_fang_et_al_genotypes)

maize_ded <- data.frame(lapply(maize_fang_et_al_genotypes, as.character), stringsAsFactors=FALSE)
maize_ded <- data.frame(sapply(maize_ded,function(x) {x <- gsub("?","-",x,fixed=TRUE)}))

teosinte_ded <- data.frame(lapply(teosinte_fang_et_al_genotypes, as.character), stringsAsFactors=FALSE)
teosinte_ded <- data.frame(sapply(teosinte_ded,function(x) {x <- gsub("?","-",x,fixed=TRUE)}))

for (i in 1:10) {
  maize <- filter(maize_fang_et_al_genotypes, Chromosome == i)
  maize <- arrange(maize, Position)
  outpath <- "c:/Users/46554/github/R-Assignment/Tianqili-R-Assignment/submit"
  nam <- sapply(
    names(maize),function(x){
                    paste("maize_in", i, ".csv", sep='')
    })
  out_filePath <- sapply(nam, function(x){
                     paste(outpath, x, sep='/')})
  write.csv(maize, file=out_filePath[i])
} #10 of maize increase data

for (i in 1:10) {
  teosinte <- filter(teosinte_fang_et_al_genotypes, Chromosome == i)
  teosinte <- arrange(teosinte, Position)
  outpath <- "c:/Users/46554/github/R-Assignment/Tianqili-R-Assignment/submit"
  nam <- sapply(
    names(teosinte),function(x){
                    paste("teosinte_in", i, ".csv", sep='')
    })
  out_filePath <- sapply(nam, function(x){
                     paste(outpath, x, sep='/')})
  write.csv(teosinte, file=out_filePath[i])
} #10 of teosinte increase data


for (i in 1:10) {
  maize <- filter(maize_ded, Chromosome == i)
  maize <- arrange(maize, desc(Position))
  outpath <- "c:/Users/46554/github/R-Assignment/Tianqili-R-Assignment/submit"
  nam <- sapply(
    names(maize),function(x){
                    paste("maize_de", i, ".csv", sep='')
    })
  out_filePath <- sapply(nam, function(x){
                     paste(outpath, x, sep='/')})
  write.csv(maize, file=out_filePath[i])
}

for (i in 1:10) {
  teosinte <- filter(teosinte_ded, Chromosome == i)
  teosinte <- arrange(teosinte, desc(Position))
  outpath <- "c:/Users/46554/github/R-Assignment/Tianqili-R-Assignment/submit"
  nam <- sapply(
    names(teosinte),function(x){
                    paste("teosinte_dd", i, ".csv", sep='')
    })
  out_filePath <- sapply(nam, function(x){
                     paste(outpath, x, sep='/')})
  write.csv(teosinte, file=out_filePath[i])
}

```


```{r}
#Part2
if (!require("tidyverse")) install.packages("tidyverse")
library(tidyverse)
if (!require("reshape2")) install.packages("reshape2")
library(reshape2)

fang_et_al_genotypes <- read_tsv ("https://raw.githubusercontent.com/Kakashi-sensei/Tianqili-R-Assignment/master/fang_et_al_genotypes.txt")

snp_position <- read_tsv ("https://raw.githubusercontent.com/Kakashi-sensei/Tianqili-R-Assignment/master/snp_position.txt")

maize_fang_et_al_genotypes <- filter(fang_et_al_genotypes, Group == "ZMMLR" | Group == "ZMMIL" | Group == "ZMMMR")

teosinte_fang_et_al_genotypes <- filter(fang_et_al_genotypes, Group == "ZMPBA" | Group == "ZMPIL" | Group == "ZMPJA")

maize_fang_et_al_genotypes <- maize_fang_et_al_genotypes[,-c(1,2,3)]

maize_fang_et_al_genotypes <- t (maize_fang_et_al_genotypes)

teosinte_fang_et_al_genotypes <- teosinte_fang_et_al_genotypes[,-c(1,2,3)]

teosinte_fang_et_al_genotypes <- t (teosinte_fang_et_al_genotypes)

snp_position <- snp_position[,-c(2,5:15)]

arrange(snp_position, SNP_ID)

maize_fang_et_al_genotypes <- cbind(snp_position, maize_fang_et_al_genotypes)

teosinte_fang_et_al_genotypes <- cbind(snp_position, teosinte_fang_et_al_genotypes)
```


```{r}

summarise(group_by(maize_fang_et_al_genotypes, Chromosome), number_Chr=n())
          

ggplot(data= ) + geom_point(mapping=aes(x=Chromosome, y=number_Chr))
```


```{r}

summarise(group_by(x,name),a=n()


SNPs_numbers <- maize_fang_et_al_genotypes %>%
    group_by("Chromosome") %>%
    count()


ggplot(data = dvst) + 
  geom_bar(mapping = aes(x = cent))

summarise(maize_fang_et_al_genotypes)


m_mel <- melt(maize_fang_et_al_genotypes, c("Chromosome"))

```

